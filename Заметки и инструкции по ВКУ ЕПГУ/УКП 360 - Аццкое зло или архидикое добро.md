# УКП 360 или почему это дикое добро, хотя и показалось аццким злом
[УКП 360 1.0.2](https://vku.test.gosuslugi.ru/template/11276/1.0.2)
УКП 360 прекрасен в своём исполнении, но по неопытности или ещё какой-либо недоконца разберихи на ЕСКС, он может ввести в смуту при наличии в услуге 14 и 15 статусов
![[Взятое с шаблона УКП для внедрения или оригинал.png]]
Комментарий `код_услуги` - подсказывает, что надо передать сервисный код вашей услуги как он есть
![[Настройки УКП дефолт.png]]
Но существуют некоторые незначительные нюансы, которые всю малину портят:
KF - это подписание заявления, когда оно в статусе 0, т.е. ServiceInfo.StatusId = 0, или заявление в статусе черновика и не спешить быть подписанным
Значение, передаваемое в компонент:
```json
{"proposedSignOptions": ["PEP", "PEP_SMS", "KF_UKEP", "GOSKEY_UKEP", "GOSKEY_UNEP", "GOSKEY_CHIEF"]}
```
В нём перечислены все доступные виды подписей:
* ПЭП
* ПЭП + СМС
* KF_UKEP - УКЭП с компьютера
* GOSKEY_UKEP - УКЭП в МП Госключ для сотрудников
* GOSKEY_UNEP - УНЭП в МП Госключ для сотрудников
* GOSKEY_CHIEF - УКЭП в МП Госключ для руководителей (ранее было недоступно, но с конца мая 2025 года реализовали и такое)
Соответственно, список можно корректировать, если какие-то загруженные файлы недопустимы для подписания в МП Госключ, тогда такие варианты подписи будут недоступны
Если же нужно разделить физиков и ИП с ЮЛ, тогда надо идти через linkedValues, и сразу же v2, т.к. так удобнее
![[Настройки УКП 18+.png]]
```json
{
    "expression1": "getIf(arg1 == 'empty', arg2)",
    "expression2": "arg3",
    "arg1": "'${protected.orgType}'",
    "arg2": "'{\"proposedSignOptions\": [\"PEP\"]}'",
    "arg3": "'{\"proposedSignOptions\": [\"KF_UKEP\", \"GOSKEY_UKEP\", \"GOSKEY_UNEP\", \"GOSKEY_CHIEF\"]}'"
}
```
В нашем случае, у физика доступно только ПЭП, т.к. такое предусмотрено ОЦС
Для сотрудников ЮЛ и ИП доступны все виды подписей, кроме ПЭП и ПЭП + СМС, для руководителей стало доступно подписание в МП Госключ
Если доступных подписей не обнаружено, значит у учётной записи тестовой протух сертификат электронной подписи
# Теперь про нюансы 14 и 15 статусов
![[15 статус.png]]
Так выглядеть должен miniApp, который добавляется вручную. Ключевые моменты:
`KF` заменён на `STATE15`, ИД компонента должен совпадать в ссылке на приложение
Такое же правило и для 14 статуса
![[14 статус как настроить УКП.png]]